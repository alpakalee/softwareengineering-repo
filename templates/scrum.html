<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>스크럼 보드</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='global.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='scrum.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='topbar.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='sidebar.css') }}"
    />
  </head>
  <body>
    {% include 'topbar.html' %}
    <div class="main-container">
      {% include 'sidebar.html' %}
      <div class="content">
        <!-- 메인 콘텐츠가 들어갈 부분 -->
        {% block content %}
        <div class="scrum-title-wrapper">
          <div class="title-right">
            <h1>스크럼 보드</h1>
            <div class="sprint-change-btn">
              <h2>{{ selected_sprint.sprint_name if selected_sprint else '선택된 스프린트가 없습니다' }}</h2>
              <img src="/static/icons/chevron-down.svg" />
              <div class="sprint-dropdown" id="sprintDropdown">
                <ul>
                  {% for sprint in sprints %}
                  <li onclick="changeSprint({{ sprint.sprint_id }})">{{ sprint.sprint_name }}</li>
                  {% endfor %}
                </ul>
              </div>
            </div>
          </div>

          <div class="sprint-percentage-container">
            <p>스프린트 작업 완료율</p>
            <div class="sprint-bar"></div>
          </div>
        </div>

        <div class="scrum-board-container">
          {% if backlogs_by_status %}
          {% for status in ['To Do', 'In Progress', 'Done'] %}
          {# <div class="todo-container"> #}
            <div class="{{ status|lower|replace(' ', '-') }}-container">
            <h1 class="scrum-board-title">{{ status }}</h1>
            <div
              class="scrum-content"
              id="{{ status|lower|replace(' ', '-') }}"
              ondrop="drop(event)"
              ondragover="allowDrop(event)"
            >
            {% for backlog in backlogs_by_status[status] %}
            <div
              class="scrum-sprint-item"
              id="item-{{ backlog.sprint_backlog_id }}"
              draggable="true"
              ondragstart="drag(event)"
              data-backlog-id="{{ backlog.sprint_backlog_id }}"
            >
                <p>{{ backlog.sprint_backlog_content }}</p>
                <span class="user-circle"> {{ backlog.user_id }} </span>
              </div>
              {% endfor %}
            </div>
          </div>
          {% endfor %}
          {% else %}
            <p>백로그 정보가 없습니다.</p>
          {% endif %}
        </div>
        {% endblock %}
      </div>
    </div>

    <!-- 외부 JavaScript 파일 연결 -->
    <script src="{{ url_for('static', filename='js/scrum.js') }}"></script>
  </body>
</html>
